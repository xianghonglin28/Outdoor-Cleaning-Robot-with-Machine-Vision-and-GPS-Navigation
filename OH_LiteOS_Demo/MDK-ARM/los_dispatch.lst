


ARM Macro Assembler    Page 1 


    1 00000000         ;
    2 00000000         ; Copyright (c) 2013-2019 Huawei Technologies Co., Ltd. 
                       All rights reserved.
    3 00000000         ; Copyright (c) 2020-2021 Huawei Device Co., Ltd. All ri
                       ghts reserved.
    4 00000000         ;
    5 00000000         ; Redistribution and use in source and binary forms, wit
                       h or without modification,
    6 00000000         ; are permitted provided that the following conditions a
                       re met:
    7 00000000         ;
    8 00000000         ; 1. Redistributions of source code must retain the abov
                       e copyright notice, this list of
    9 00000000         ;    conditions and the following disclaimer.
   10 00000000         ;
   11 00000000         ; 2. Redistributions in binary form must reproduce the a
                       bove copyright notice, this list
   12 00000000         ;    of conditions and the following disclaimer in the d
                       ocumentation and/or other materials
   13 00000000         ;    provided with the distribution.
   14 00000000         ;
   15 00000000         ; 3. Neither the name of the copyright holder nor the na
                       mes of its contributors may be used
   16 00000000         ;    to endorse or promote products derived from this so
                       ftware without specific prior written
   17 00000000         ;    permission.
   18 00000000         ;
   19 00000000         ; THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
                        CONTRIBUTORS
   20 00000000         ; "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDI
                       NG, BUT NOT LIMITED TO,
   21 00000000         ; THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS 
                       FOR A PARTICULAR
   22 00000000         ; PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGH
                       T HOLDER OR
   23 00000000         ; CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCID
                       ENTAL, SPECIAL,
   24 00000000         ; EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NO
                       T LIMITED TO,
   25 00000000         ; PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF U
                       SE, DATA, OR PROFITS;
   26 00000000         ; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY TH
                       EORY OF LIABILITY,
   27 00000000         ; WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUD
                       ING NEGLIGENCE OR
   28 00000000         ; OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS S
                       OFTWARE, EVEN IF
   29 00000000         ; ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
   30 00000000         ;
   31 00000000         
   32 00000000                 PRESERVE8
   33 00000000         
   34 00000000                 EXPORT           HalIntLock
   35 00000000                 EXPORT           HalIntUnLock
   36 00000000                 EXPORT           HalIntRestore
   37 00000000                 EXPORT           HalStartToRun
   38 00000000                 EXPORT           HalTaskSchedule
   39 00000000                 EXPORT           HalPendSV
   40 00000000                 IMPORT           OsSchedTaskSwitch



ARM Macro Assembler    Page 2 


   41 00000000                 IMPORT           g_losTask
   42 00000000         
   43 00000000 E000ED88 
                       OS_FPU_CPACR
                               EQU              0xE000ED88
   44 00000000 00F00000 
                       OS_FPU_CPACR_ENABLE
                               EQU              0x00F00000
   45 00000000 E000ED04 
                       OS_NVIC_INT_CTRL
                               EQU              0xE000ED04
   46 00000000 E000ED20 
                       OS_NVIC_SYSPRI2
                               EQU              0xE000ED20
   47 00000000 F0F00000 
                       OS_NVIC_PENDSV_PRI
                               EQU              0xF0F00000
   48 00000000 10000000 
                       OS_NVIC_PENDSVSET
                               EQU              0x10000000
   49 00000000 00000010 
                       OS_TASK_STATUS_RUNNING
                               EQU              0x0010
   50 00000000         
   51 00000000         ;    SECTION    .text:CODE(2)      ;将该段注释（在最前面
                       加;）
   52 00000000         ; for keil compiler
   53 00000000         ;    AREA    |.text|, CODE, READONLY, ALIGN=2 
   54 00000000                 AREA             |.text|, CODE, READONLY 
                                                            ;换成这个
   55 00000000         
   56 00000000                 THUMB
   57 00000000                 REQUIRE8
   58 00000000         
   59 00000000         HalStartToRun
   60 00000000 4C39            LDR              R4, =OS_NVIC_SYSPRI2
   61 00000002 4D3A            LDR              R5, =OS_NVIC_PENDSV_PRI
   62 00000004 6025            STR              R5, [R4]
   63 00000006         
   64 00000006 F04F 0002       MOV              R0, #2
   65 0000000A F380 8814       MSR              CONTROL, R0
   66 0000000E         
   67 0000000E 4938            LDR              R1, =g_losTask
   68 00000010 6848            LDR              R0, [R1, #4]
   69 00000012 F8D0 C000       LDR              R12, [R0]
   70 00000016         
   71 00000016 F8DF 10DC       LDR.W            R1, =OS_FPU_CPACR
   72 0000001A 6809            LDR              R1, [R1]
   73 0000001C F401 0170       AND              R1, R1, #OS_FPU_CPACR_ENABLE
   74 00000020 F5B1 0F70       CMP              R1, #OS_FPU_CPACR_ENABLE
   75 00000024 D10E            BNE              __DisabledFPU
   76 00000026 F10C 0C64       ADD              R12, R12, #100
   77 0000002A         
   78 0000002A E8BC 00FF       LDMFD            R12!, {R0-R7}
   79 0000002E F10C 0C48       ADD              R12, R12, #72
   80 00000032 F38C 8809       MSR              PSP, R12
   81 00000036 ED2D 0A01       VPUSH            S0          ;
   82 0000003A ECBD 0A01       VPOP             S0          ;
   83 0000003E 46AE            MOV              LR, R5



ARM Macro Assembler    Page 3 


   84 00000040 B662            CPSIE            I
   85 00000042 4730            BX               R6
   86 00000044         
   87 00000044         __DisabledFPU
   88 00000044 F10C 0C24       ADD              R12, R12, #36
   89 00000048         
   90 00000048 E8BC 00FF       LDMFD            R12!, {R0-R7}
   91 0000004C F38C 8809       MSR              PSP, R12
   92 00000050 46AE            MOV              LR, R5
   93 00000052 B662            CPSIE            I
   94 00000054 4730            BX               R6
   95 00000056         
   96 00000056         
   97 00000056         HalIntLock
   98 00000056 F3EF 8010       MRS              R0, PRIMASK
   99 0000005A B672            CPSID            I
  100 0000005C 4770            BX               LR
  101 0000005E         
  102 0000005E         HalIntUnLock
  103 0000005E F3EF 8010       MRS              R0, PRIMASK
  104 00000062 B662            CPSIE            I
  105 00000064 4770            BX               LR
  106 00000066         
  107 00000066         HalIntRestore
  108 00000066 F380 8810       MSR              PRIMASK, R0
  109 0000006A 4770            BX               LR
  110 0000006C         
  111 0000006C         HalTaskSchedule
  112 0000006C 4822            LDR              R0, =OS_NVIC_INT_CTRL
  113 0000006E F04F 5180       LDR              R1, =OS_NVIC_PENDSVSET
  114 00000072 6001            STR              R1, [R0]
  115 00000074 F3BF 8F4F       DSB
  116 00000078 F3BF 8F6F       ISB
  117 0000007C 4770            BX               LR
  118 0000007E         
  119 0000007E         HalPendSV
  120 0000007E F3EF 8C10       MRS              R12, PRIMASK
  121 00000082 B672            CPSID            I
  122 00000084         
  123 00000084         HalTaskSwitch
  124 00000084 E92D 5000       PUSH             {R12, LR}
  125 00000088         ;    BLX     OsSchedTaskSwitch
  126 00000088 F8DF C070       LDR              R12, =OsSchedTaskSwitch
  127 0000008C 47E0            BLX              R12
  128 0000008E         ; BLX not supported on targeted CPU, keil STM32F407
  129 0000008E         ;
  130 0000008E E8BD 5000       POP              {R12, LR}
  131 00000092 2800            CMP              R0, #0
  132 00000094 4670            MOV              R0, LR
  133 00000096 D102            BNE              TaskContextSwitch
  134 00000098 F38C 8810       MSR              PRIMASK, R12
  135 0000009C 4770            BX               LR
  136 0000009E         
  137 0000009E         TaskContextSwitch
  138 0000009E 4686            MOV              LR, R0
  139 000000A0 F3EF 8009       MRS              R0, PSP
  140 000000A4         
  141 000000A4 E920 1FF0       STMFD            R0!, {R4-R12}
  142 000000A8 F8DF 3048       LDR.W            R3, =OS_FPU_CPACR



ARM Macro Assembler    Page 4 


  143 000000AC 681B            LDR              R3, [R3]
  144 000000AE F403 0370       AND              R3, R3, #OS_FPU_CPACR_ENABLE
  145 000000B2 F5B3 0F70       CMP              R3, #OS_FPU_CPACR_ENABLE
  146 000000B6 D101            BNE              __DisabledFPU1
  147 000000B8 ED20 8B10       VSTMDB           R0!, {D8-D15}
  148 000000BC         
  149 000000BC         __DisabledFPU1
  150 000000BC 4D0C            LDR              R5, =g_losTask
  151 000000BE 682E            LDR              R6, [R5]
  152 000000C0 6030            STR              R0, [R6]
  153 000000C2         
  154 000000C2 6868            LDR              R0, [R5, #4]
  155 000000C4 6028            STR              R0, [R5]
  156 000000C6         
  157 000000C6 6801            LDR              R1, [R0]
  158 000000C8 F403 0370       AND              R3, R3, #OS_FPU_CPACR_ENABLE
  159 000000CC F5B3 0F70       CMP              R3, #OS_FPU_CPACR_ENABLE
  160 000000D0 D101            BNE              __DisabledFPU2
  161 000000D2 ECB1 8B10       VLDMIA           R1!, {D8-D15}
  162 000000D6         
  163 000000D6         __DisabledFPU2
  164 000000D6 E8B1 1FF0       LDMFD            R1!, {R4-R12}
  165 000000DA F381 8809       MSR              PSP,  R1
  166 000000DE         
  167 000000DE F38C 8810       MSR              PRIMASK, R12
  168 000000E2 4770            BX               LR
  169 000000E4 BF00            NOP                          ;Tab缩进后加BOP
  170 000000E6                 END
              00 00 E000ED20 
              F0F00000 
              00000000 
              E000ED88 
              E000ED04 
              00000000 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M4.fp.sp --apcs=
interwork --depend=oh_liteos_demo\los_dispatch.d -ooh_liteos_demo\los_dispatch.
o -I.\RTE\_OH_LiteOS_Demo -IE:\mdkkkk\ARM\CMSIS\5.8.0\CMSIS\Core\Include -IE:\m
dkkkk\Keil\STM32F4xx_DFP\2.17.1\Drivers\CMSIS\Device\ST\STM32F4xx\Include --pre
define="__MICROLIB SETA 1" --predefine="__UVISION_VERSION SETA 536" --predefine
="_RTE_ SETA 1" --predefine="STM32F407xx SETA 1" --predefine="_RTE_ SETA 1" --l
ist=los_dispatch.lst ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 54 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      None
Comment: .text unused
HalIntLock 00000056

Symbol: HalIntLock
   Definitions
      At line 97 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 34 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: HalIntLock used once
HalIntRestore 00000066

Symbol: HalIntRestore
   Definitions
      At line 107 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 36 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: HalIntRestore used once
HalIntUnLock 0000005E

Symbol: HalIntUnLock
   Definitions
      At line 102 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 35 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: HalIntUnLock used once
HalPendSV 0000007E

Symbol: HalPendSV
   Definitions
      At line 119 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 39 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: HalPendSV used once
HalStartToRun 00000000

Symbol: HalStartToRun
   Definitions
      At line 59 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 37 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: HalStartToRun used once
HalTaskSchedule 0000006C

Symbol: HalTaskSchedule
   Definitions
      At line 111 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 38 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: HalTaskSchedule used once
HalTaskSwitch 00000084

Symbol: HalTaskSwitch



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 123 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      None
Comment: HalTaskSwitch unused
TaskContextSwitch 0000009E

Symbol: TaskContextSwitch
   Definitions
      At line 137 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 133 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: TaskContextSwitch used once
__DisabledFPU 00000044

Symbol: __DisabledFPU
   Definitions
      At line 87 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 75 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: __DisabledFPU used once
__DisabledFPU1 000000BC

Symbol: __DisabledFPU1
   Definitions
      At line 149 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 146 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: __DisabledFPU1 used once
__DisabledFPU2 000000D6

Symbol: __DisabledFPU2
   Definitions
      At line 163 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 160 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: __DisabledFPU2 used once
12 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

OS_FPU_CPACR E000ED88

Symbol: OS_FPU_CPACR
   Definitions
      At line 43 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 71 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
      At line 142 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S

OS_FPU_CPACR_ENABLE 00F00000

Symbol: OS_FPU_CPACR_ENABLE
   Definitions
      At line 44 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 73 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
      At line 74 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
      At line 144 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
      At line 145 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
      At line 158 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
      At line 159 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S

OS_NVIC_INT_CTRL E000ED04

Symbol: OS_NVIC_INT_CTRL
   Definitions
      At line 45 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 112 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: OS_NVIC_INT_CTRL used once
OS_NVIC_PENDSVSET 10000000

Symbol: OS_NVIC_PENDSVSET
   Definitions
      At line 48 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 113 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: OS_NVIC_PENDSVSET used once
OS_NVIC_PENDSV_PRI F0F00000

Symbol: OS_NVIC_PENDSV_PRI
   Definitions
      At line 47 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 61 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: OS_NVIC_PENDSV_PRI used once
OS_NVIC_SYSPRI2 E000ED20

Symbol: OS_NVIC_SYSPRI2
   Definitions
      At line 46 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 60 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: OS_NVIC_SYSPRI2 used once
OS_TASK_STATUS_RUNNING 00000010

Symbol: OS_TASK_STATUS_RUNNING
   Definitions
      At line 49 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

   Uses
      None
Comment: OS_TASK_STATUS_RUNNING unused
7 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

OsSchedTaskSwitch 00000000

Symbol: OsSchedTaskSwitch
   Definitions
      At line 40 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 126 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
Comment: OsSchedTaskSwitch used once
g_losTask 00000000

Symbol: g_losTask
   Definitions
      At line 41 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
   Uses
      At line 67 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S
      At line 150 in file ..\LiteOS_M\arch\arm\cortex-m4\iar\los_dispatch.S

2 symbols
358 symbols in table
